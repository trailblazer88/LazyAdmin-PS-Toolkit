Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing

function Get-EventDetails {
    param (
        [System.Diagnostics.Eventing.Reader.EventRecord]$event
    )

    $data = [xml]$event.ToXml()
    $eventID = $event.Id
    $timestamp = $event.TimeCreated
    $dc = $event.MachineName

    $eventData = @{
        EventID          = $eventID
        DomainController = $dc
        Timestamp        = $timestamp
        CallerComputer   = ""
        Reason           = ""
    }

    switch ($eventID) {
        4740 {
            $eventData.CallerComputer = ($data.Event.EventData.Data | Where-Object { $_.Name -eq "CallerComputerName" }).'#text'
            $eventData.Reason = "Account Lockout"
        }
        4625 {
            $eventData.CallerComputer = ($data.Event.EventData.Data | Where-Object { $_.Name -eq "WorkstationName" }).'#text'
            $status = ($data.Event.EventData.Data | Where-Object { $_.Name -eq "Status" }).'#text'
            $subStatus = ($data.Event.EventData.Data | Where-Object { $_.Name -eq "SubStatus" }).'#text'
            $eventData.Reason = "Failed Logon - Status: $status"
        }
        4771 {
            $eventData.CallerComputer = ($data.Event.EventData.Data | Where-Object { $_._
